{
  "version": "1.0.0",
  "description": "Security configuration for DepUp package processing",
  "policies": {
    "containerization": {
      "enabled": true,
      "isolation_level": "sandbox",
      "network_access": "registry_only",
      "filesystem_access": "restricted",
      "resource_limits": {
        "cpu": "0.5",
        "memory": "1g",
        "disk": "2g",
        "timeout": 300
      }
    },
    "malware_scanning": {
      "enabled": true,
      "engines": ["clamav", "yara"],
      "scan_depth": "full",
      "quarantine_infected": true,
      "fail_on_detection": true
    },
    "vulnerability_scanning": {
      "enabled": true,
      "tools": ["npm-audit", "snyk", "owasp-dependency-check"],
      "severity_threshold": "moderate",
      "fail_on_critical": true,
      "fail_on_high": true,
      "update_dependencies": true
    },
    "dependency_analysis": {
      "enabled": true,
      "check_conflicts": true,
      "validate_compatibility": true,
      "license_check": true,
      "supply_chain_risks": true
    },
    "package_validation": {
      "enabled": true,
      "allowlist_required": true,
      "size_limits": {
        "max_package_size_mb": 100,
        "max_extracted_size_mb": 500,
        "max_file_count": 10000
      },
      "content_checks": {
        "block_executables": true,
        "block_scripts": true,
        "block_hidden_files": false,
        "validate_package_json": true
      }
    },
    "publishing": {
      "enabled": true,
      "require_security_clearance": true,
      "add_security_attestation": true,
      "quarantine_mode": false,
      "notify_on_anomalies": true
    }
  },
  "monitoring": {
    "enabled": true,
    "metrics_collection": true,
    "alerts": {
      "security_violations": true,
      "malware_detections": true,
      "vulnerability_findings": true,
      "processing_failures": true
    },
    "logging": {
      "security_events": true,
      "processing_logs": true,
      "audit_trail": true
    }
  },
  "emergency": {
    "circuit_breaker": {
      "enabled": true,
      "failure_threshold": 5,
      "recovery_timeout_minutes": 60
    },
    "quarantine_mode": {
      "enabled": true,
      "auto_activate_on_threats": true,
      "manual_override_required": true
    }
  },
  "compliance": {
    "gdpr_compliant": true,
    "data_retention_days": 90,
    "audit_logging": true,
    "transparency_reports": true
  }
}
